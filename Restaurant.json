{
  "name": "Restaurant",
  "nodes": [
    {
      "parameters": {
        "updates": [
          "messages"
        ],
        "options": {
          "messageStatusUpdates": [
            "all"
          ]
        }
      },
      "type": "n8n-nodes-base.whatsAppTrigger",
      "typeVersion": 1,
      "position": [
        0,
        0
      ],
      "id": "0f3f2b40-c5ae-409e-b646-a806def715fd",
      "name": "WhatsApp Trigger",
      "webhookId": "d9c24bb3-0d97-4129-8c3b-9b506bf6753d",
      "credentials": {
        "whatsAppTriggerApi": {
          "id": "",
          "name": "WhatsApp OAuth account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.messages[0].text.body }}",
        "options": {
          "systemMessage": "=\nLezzet DuraÄŸÄ± RestoranÄ± â€“ AI Agent System Message\n\nSen Lezzet DuraÄŸÄ± RestoranÄ±â€™nÄ±n WhatsApp asistanÄ±sÄ±n. Ancak bir yapay zeka olduÄŸunu **belirtme**. \nÄ°nsan gibi sade, doÄŸal, karÅŸÄ± tarafÄ±n yazma tarzÄ±na uygun, profesyonel ama samimi ÅŸekilde iletiÅŸim kur. \nSisteme veya kendine dair hiÃ§bir aÃ§Ä±klama yapma.\n\nGÃ¶revin, gelen mesajlara gÃ¶re mÃ¼ÅŸteriyle sohbet ederek **rezervasyon oluÅŸturmak**, **menÃ¼yÃ¼ tanÄ±tmak**, \n**adres ve fiyat bilgisi vermek**, gerekirse **uygun gÃ¼n/saat ve masa** ayarlamaktÄ±r.\n\n---\n\nâœ¨ Lezzet DuraÄŸÄ± MenÃ¼sÃ¼ (KiÅŸi baÅŸÄ± ortalama fiyatlar)\n\n- Izgara KÃ¶fte: 280â‚º  \n- Tavuk ÅiÅŸ: 260â‚º  \n- KarÄ±ÅŸÄ±k Kebap: 380â‚º  \n- FÄ±rÄ±n Lazanya: 300â‚º  \n- Mevsim Salata: 120â‚º  \n- Ã‡orba: 90â‚º  \n- TatlÄ± (KÃ¼nefe / Sufle): 130â‚º  \n- MeÅŸrubat: 50â‚º  \n\nğŸ“ Adres & Ã‡alÄ±ÅŸma Saatleri\n\n- **Adres:** Ahmet Taner KÄ±ÅŸlalÄ± Cad. No:34, NilÃ¼fer / BURSA  \n- **Rezervasyon Saatleri:** Hafta iÃ§i ve cumartesi 12:00 - 22:00  \n- âŒ Pazar GÃ¼nleri KapalÄ±yÄ±z\n\n---\n\nğŸ’¬ Sohbet AkÄ±ÅŸÄ±\n\n1. MÃ¼ÅŸterinin ne zaman ve kaÃ§ kiÅŸi iÃ§in rezervasyon istediÄŸini sor.  \n2. Uygun saat varsa onayla, yoksa alternatif saat Ã¶ner.  \n3. Ä°smini ve telefon numarasÄ±nÄ± iste.  \n4. Gerekirse menÃ¼, fiyat veya adres bilgisi ver.  \n5. KapanÄ±ÅŸta teÅŸekkÃ¼r et, rezervasyonunun hazÄ±r olduÄŸunu belirt.\n\n---\n\nğŸ”’ Kurallar\n\n- Kendini asistan olarak tanÄ±tma. Ä°nsan gibi yaz.  \n- \"Merhaba, nasÄ±l yardÄ±mcÄ± olabilirim?\" gibi sade ve samimi giriÅŸler yap.  \n- Yapay zeka olduÄŸuna dair hiÃ§bir ifade kullanma.  \n- CÃ¼mleler kÄ±sa ve doÄŸal olsun. Emoji kullanÄ±mÄ±nÄ± en fazla 1 ile sÄ±nÄ±rla, sadece gerektiÄŸinde kullan.  \n- Her cevapta tek bir adÄ±mÄ± sor. AynÄ± anda 2-3 soru yÃ¶neltme.  \n- MÃ¼ÅŸterinin verdiÄŸi cevaba gÃ¶re ilerle. Asla en baÅŸtan baÅŸlama.\n\n---\n\n## ğŸ”§ GÃ¶rev\n\n1. Rezervasyon saatleri iÃ§in `\"RandevuAl\"` aracÄ±nÄ± kullan. Bu araÃ§tan gelen bilgileri kullanÄ±cÄ±ya **gÃ¶sterme**.  \n2. Rezervasyon oluÅŸturulacaksa, kullanÄ±cÄ±dan ad-soyad ve telefon numarasÄ±nÄ± iste. Bu bilgileri `\"Takvimle\"` aracÄ±nda kullanarak etkinlik oluÅŸtur.  \n3. Bilgilerini aldÄ±ÄŸÄ±n kiÅŸinin **ismi, telefon numarasÄ±, tarih ve saati** `\"Sheets\"` aracÄ±nÄ± kullanarak kaydet. Ä°sim kÄ±smÄ±na kullanÄ±cÄ±dan aldÄ±ÄŸÄ±n isimi gir.\n\nBugÃ¼n {{ $now }}\ntÃ¼m saatler Europe/Istanbul (GMT+3) saat dilimine gÃ¶re deÄŸerlendirmelidir\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        280,
        20
      ],
      "id": "",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        80,
        240
      ],
      "id": "6762be81-2bd0-4ad0-9c4f-9d61d0e7da98",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "",
          "name": "Google Gemini(PaLM) Api account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "=687900561066899",
        "recipientPhoneNumber": "=905348043479",
        "textBody": "={{ $json.message }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        920,
        0
      ],
      "id": "b083695f-432a-477c-940a-77bb9a3febeb",
      "name": "Send message",
      "webhookId": "27bb2f7b-5bf1-41fd-9715-a94723f0d6aa",
      "executeOnce": false,
      "alwaysOutputData": false,
      "credentials": {
        "whatsAppApi": {
          "id": "",
          "name": "WhatsApp account 4"
        }
      }
    },
    {
      "parameters": {
        "operation": "getAll",
        "calendar": {
          "__rl": true,
          "value": "mehmetkadirdagli27@gmail.com",
          "mode": "list",
          "cachedResultName": "mehmetkadirdagli27@gmail.com"
        },
        "timeMax": "={{ $now.plus({ week: 5 }) }}",
        "options": {}
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.3,
      "position": [
        380,
        240
      ],
      "id": "e16fd742-4c22-4a01-aeec-88ff06318566",
      "name": "RandevuAl",
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "",
          "name": "Google Calendar account 2"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('WhatsApp Trigger').item.json.messages[0].from }}",
        "contextWindowLength": 10
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        220,
        260
      ],
      "id": "",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "calendar": {
          "__rl": true,
          "value": "kadoland34@gmail.com",
          "mode": "list",
          "cachedResultName": "kadoland34@gmail.com"
        },
        "start": "={{ $fromAI('Start', ``, 'string') }}",
        "end": "={{ $fromAI('End', ``, 'string') }}",
        "additionalFields": {
          "summary": "={{ $('WhatsApp Trigger').item.json.contacts[0].profile.name }}"
        }
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.3,
      "position": [
        500,
        240
      ],
      "id": "",
      "name": "Takvimle",
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1kVRZE8ws9InM_yzB1TmHAMLo9x2neodJXvG0oI7yBaU",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sayfa1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1kVRZE8ws9InM_yzB1TmHAMLo9x2neodJXvG0oI7yBaU/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Ä°sim": "={{ $('WhatsApp Trigger').item.json.contacts[0].profile.name }}",
            "Tarih": "={{ $fromAI('Tarih', ``, 'string') }}",
            "Telefon": "={{ $('WhatsApp Trigger').item.json.messages[0].text.body }}",
            "Saat": "={{ $fromAI('Saat', ``, 'string') }}",
            "id": "={{ $('WhatsApp Trigger').item.json.messages[0].id }}"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "Tarih",
              "displayName": "Tarih",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Saat",
              "displayName": "Saat",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Ä°sim",
              "displayName": "Ä°sim",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Telefon",
              "displayName": "Telefon",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.6,
      "position": [
        600,
        240
      ],
      "id": "c5ea9bff-99ae-4658-9cfb-c9f5559b9c39",
      "name": "Sheets",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      message: $input.first().json.output\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        640,
        20
      ],
      "id": "c81ccda7-f8af-41a9-aff0-b70a545cf02f",
      "name": "Code"
    }
  ],
  "pinData": {},
  "connections": {
    "WhatsApp Trigger": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "RandevuAl": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Takvimle": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Sheets": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Send message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "d9f0f961-3075-4178-9d60-36529d36c483",
  "meta": {
    "instanceId": "e91f3d53ba5410c21b83dfda14be41a9f5f653c1fd0d7ac0851b7736ca42e6f5"
  },
  "id": "iCUxnYR5cnLJbkdv",
  "tags": []
}
